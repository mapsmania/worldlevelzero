<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body { background:#111;margin:0;overflow:hidden; }
  svg  { display:block;margin:auto; }
</style>
<body>
<svg width="960" height="500"></svg>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>
<script src="https://unpkg.com/d3-geo-projection@4"></script>
<script>
const width = 960, height = 500;
const svg = d3.select("svg");
const path = d3.geoPath();

d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(world => {
  const countries = topojson.feature(world, world.objects.countries).features;

  const g = svg.append("g")
    .attr("fill", "#4CAF50")
    .attr("stroke", "#222")
    .selectAll("path")
    .data(countries)
    .join("path");

  const projA = d3.geoMercator().scale(150).translate([width/2,height/2]);
  const projB = d3.geoMollweide().scale(150).translate([width/2,height/2]);

  let t = 0, dir = 1;
  function frame(){
    t += dir * 0.01;
    if(t>=1){t=1;dir=-1;}
    if(t<=0){t=0;dir=1;}

    const interpProj = d3.geoProjection((lambda, phi)=>{
      const lon=lambda*180/Math.PI, lat=phi*180/Math.PI;
      const a=projA([lon,lat]), b=projB([lon,lat]);
      if(!a||!b||!isFinite(a[0])||!isFinite(a[1])||!isFinite(b[0])||!isFinite(b[1])) return [NaN,NaN];
      return [a[0]*(1-t)+b[0]*t, a[1]*(1-t)+b[1]*t];
    })
    .scale(150).translate([width/2,height/2]);

    path.projection(interpProj);
    g.attr("d", d=>path(d));
  }

  // run at ~20fps
  d3.interval(frame,50);
});
</script>
</body>
</html>
